## Web/Application Servers
### Web Server Web服务器
使用HTTP协议向Web提供内容。
### Application Servers 应用程序服务器
托管并公开业务逻辑和进程

1. 服务器端语言及其Web框架：
- PHP ，微博，Facebook，Wordpress
- Node.js（Express）， 前后端都可用JS，高并发的情况执行效率极高；不适合CPU密集的应用，适合初创型企业， Yahoo, Walmart
- Python， 语法简单易学，数据分析相关应用多；单独使用Python相较起来运行性能较差。 Instagram, Reddit, 知乎
- Java（Spring）， 开发统治者，工作需求稳定，应用层面广
- Go， Google力推，有完善的标准库，效能强大堪比C系列；目前学习资源较少  Google， YouTube， bilibili， 头条， 腾讯云
- Ruby（Rails），开发快速，国内外很多 bootcamp 以此教学，airbnb, Twitter

2. Web服务器
除了托管自定义应用程序代码外，一些Web应用程序体系结构还使用

- **Web服务器进程**
如Apache HTTP Server, 或 Nginx。这些服务器进程将在访问后端代码之前拦截客户端请求。

使用他们的原因：
  - 快速重定向某些请求而不必通过后端代码执行此操作（404页面）
  - 存储在Web服务器的文件体系上的静态内容（如图像，css,js）比通过后端代码访问更快
  - 某些服务器语言（如PHP）没有内置的生产级Web服务器，所以需要通过专门的Web服务器进程启动

1. Apache， Nginx, tomcat, node.js
相同点： 他们都能创建Web 服务器
不同：
- Apache能和其他语言配合（通常是PHP），但需要借助不同的模块
- Nginx是通过端口转发，Apache和Nginx可以和各种编程语言一起使用
- Apache和Nginx 是纯Web服务器，不具备解析动态语言（如php,js)的能力

- Tomcat只能跟Java配合，Node.j只能和JS
- Tomcat和Node.js能解析这些脚本语言，提供应用服务，WebServer算是附加功能

- **Web Server的形式/载体**
安装这些工具和后端项目的Web服务器计算机，可以是
1. 一台物理机器
2. 虚拟专用服务器，即VPS（如阿里云，华为云）

**VPS** 实际上是被划分为几个部分的独立服务器，每个部分作为单独的VPS服务器进行销售和使用。即一台可运行多个Web应用程序（网站，软件等）的相对独立的机器，每个用户拥有部分资源。
 VPS是基于软件层的虚拟化技术，具体来说是操作系统的虚拟化；
 VM是基于硬件层的虚拟化技术，VM主机用 vmware server 搭建

- **Docker，虚拟机，物理机**
docker容器 v.s. 虚拟机
docker容器，一套房隔成多个小隔间，每个隔间一位租户，共享地基，花园，还共享卫生间，厨房和宽带
虚拟机，一栋楼包含多套房，一套房一户人家，共享地基，花园，独立卫生间，厨房和宽带
物理机，一栋楼一户人家，独立地基，独立花园


## 负载均衡器 Load Balancer
负载均衡是高可用网络基础架构的一个关键组成部分。我们可以将我们的应用服务器部署多台，通过负载均衡，将用户的请求分发到不同的服务器来提高网站，应用，数据库或其他服务的性能和可靠性。

负载均衡器主要分为硬件负载均衡和软件负载均衡两大类。软件负载均衡对应第七层（应用层）,根据应用层协议，如HTTP中的数据分发请求，应用范围主要是众多网站或内部信息平台等基于B/S开发的系统。

软件负载均衡，如LVS, Nginx，HAproxy。

负载均衡器会收到请求，并根据配置的算法将请求分发到特定的服务器。一些行业标准算法：
- 轮询调度，Round Robin
- 加权轮询，Weighted Round robin
- 最少连接数，Least connections
- 最短响应时间，Least Response Time

在Web应用程序中使用Load Balancer的好处：
- 通过确保单个Web服务器不会被所有请求淹没，来帮助维持一致的响应时间，因此处理每个请求的速度会相对慢些；
- 保持高可用性，服务器崩溃时，所有后续客户端请求仍将成功，因为它们将路由到健康的服务器，且用户不会发现任何问题。

## 域名解析系统 DNS
用户在地址栏输入URL时，浏览器获取URL的域，并调用DNS解析，DNS解析发回该网站服务器的IP地址位置。一旦它具有IP地址，就可以发送对网页的实际请求。
- 如果Web应用程序使用负载均衡器，则应将域名配置为指向负载均衡器的域名或IP地址；否则，直接指向应用程序服务器的域名/IP

大多数互联网域名注册服务都提供DNS管理控制台，运行配置域名（和子域）以指向app的位置。

还可以将DNS转移到阿里云等云提供商，并在那里进行管理。这样可以将所有app环境配置保存在一个位置，并使其更易于自动化。

DNS (Domain Name System)是互联网中的重要基础设施，负责对域名的解析工作，为了保证高可用、高并发和分布式，它设计成了树状的层次结构。

由根DNS服务器、顶级域 DNS 服务器和权威 DNS 服务器组成。

解析顺序是首先从浏览器缓存、操作系统缓存以及本地 DNS 缓存 (/etc/hosts) 逐级查找，然后从本地 DNS 服务器、根 DNS、顶级 DNS 以及权威 DNS层层递归查询。

还可以基于域名在内网、外网进行负载均衡。

不过传统的 DNS 有很多问题(解析慢、更新不及时)，HTTPDNS 通过客户端 SDK 和服务端配合，直接通过 HTTP 调用解析 DNS 的方式，可以绕过传统 DNS 这些缺点，实现智能调度。

## HTTPS/SSL证书
需要在后端，服务器上安装SSL证书。
- 可以使用LetsEncrypt免费生成证书
- 云基础架构，使用托管服务，允许你创建并自动续订SSL证书并将其分发到应用程序服务器，负载均衡器和CDN服务器
- 只有大型HTTPS证书授权中心才会被浏览器承认，否则会显示为不安全，需要手动信任。

HTTPS 就是在 HTTP 和 TCP 协议中间加入了 SSL/TLS 安全套接层。

结合非对称加密和对称加密的各自优点，配合证书。既保证了安全性，也保证了传输效率。

目前应用最广泛的是TLS1.2，实现原理如下：

1.Client 发送 random1+对称加密套件列表+非对称加密套件列表
2.Server 收到信息， 选择 对称加密套件+非对称加密套件 并和 random2+证书(公钥在证书中) 一起返回
3.Client 验证证书有效性，并用 random1+random2 生成 pre-master 通过服务器公钥加密+浏览器确认 发送给 Server
4.Server 收到 pre-master，根据约定的加密算法对 random1+random2+pre-master（解密）生成 master-secret，然后发送服务器确认
5.Client 收到生成同样的 master-secert，对称加密秘钥传输完毕
TLS1.3 则简化了握手过程，完全握手只需要一个消息往返，提升了性能。不仅如此，还对部分不安全的加密算法进行了删减。

问题：你所谓的约定的加密算法应该是 ECDHE 椭圆算法吧？HTTP 传输消息都是明文的，黑客完全可以作为中间人劫持消息，再利用 ECDHE 算法，这样不就能破解密钥了吗？

答：ECDHE 算法利用了椭圆曲线和离散对数等思想，按照当下的计算机算力，很难在短时间进行破解。且每次握手时生成的都是一对临时的公钥和私钥，这样就保证每次的密钥对也不同。

即使大费力气破解了一次的密钥，之前的历史消息也不会受到影响，保证了前向安全。

当然，TLS 协议的安全性受限于当下最快的计算机运行速度，理论上绝对安全的是量子通讯传递密钥。

## 数据库 Database
互联网中最常用的数据库主要是2种：
- 关系型(SQL),如MySql, SQLServer, Oracle, SQLite等
- 非关系型(No SQL)，MongoDB等，具有可扩展性优势和数据结构灵活性
### 数据库部署
可以在一台服务器上托管数据库，生产中常见的是托管在某种形式的集群（2台或更多服务器）上，可确保数据库具有高可用性并降低数据丢失的风险。

云托管的“无服务器数据库”，可以通过API调用的数据库，无需设置服务器来托管。

### 数据库基础方案
1. 一主一备的主备式
数据库系统一般自带主备功能。
- 数据库部署到两台机器，“主机”作为日常提供数据读写服务的机器，
- “备机”不提供线上服务，但实时将“主机”数据同步过来
- “主机”故障，人工的方式手动将“主机”踢下线，将“备机”改为“主机”来继续提供服务

优：不需什么开发改造，数据库原生支持，部署维护简单，无需引入额外的系统复杂度和瓶颈；

缺：需要运维人工干预，且资源浪费

2. 一主一从的主从式
类似主备式，但“从机”平时也提供服务，但只提供“读”服务，不提供“写”服务
- 主机实时将线上数据同步到“从机”

3. 互为主从的主主式

## Blob/文件存储
非结构化数据，不饿能由用户改变，或者基于文件，而不适合数据库存储，如：
- 前端网站资源，如图像，JS,CSS,字体，音频，视频文件
- 用户通过表单上传的各类文件

云服务供应商提供专用服务来存储这些服务，这样可以安全的存储文件，并可为其制作冗余副本，以最大限度地降低数据丢失的风险。

### Blob存储
用于：
- 直接向浏览器提供图像或文档
- 存储文件以供分布式访问
- 对视频和音频进行流式处理
- 向日志文件写入
- 存储用于备份和还原、灾难恢复及存档的数据
- 存储数据以供本地或Azure托管服务执行分析

## 内容分发网络 CDN
CDN是静态文件的一种缓存形式。

- CDN是云供应商提供的服务，在全球范围内分布有“边缘服务器”
- 这些“边缘服务器”从“原点”，如blob/文件存储位置获取文件的副本。前端web应用指向其CDN URL，而不是指向静态资源的Blob存储URL
- 客户端和“边缘”的距离更少，文件的获取速度更快

CDN（Content Delivery Network）就是内容分发网络。

为了突破现实生活中的光速、传输距离等物理限制，CDN 投入了大量资金，在全球范围内各大枢纽城市建立机房，部署大量高存储高带宽的节点，构建跨运营商、跨地域的专用高速传输网络。

其中分为中心节点、区域节点、边缘节点等，在用户接入网络后，首先通过全局负载均衡 (Global Sever Load Balance)，简称 GSLB 算法负责调度，找到离用户最合适的节点。然后通过 HTTP 缓存代理技术进行缓存，缓存命中就返回给用户，否则就回源站去取。CDN 擅长缓存静态资源(图片、音频等)，当然也支持动态内容的缓存。

### CDN工作流
1. 用户发起请求
2. 智能DNS进行解析，根据用户IP地理位置、接入网类型，选择用户路由最短、负载最轻的缓存服务器
3. 取得缓存服务器IP
4. 缓存中有目标资源？把内容返回给用户
5. 没有目标资源？向源站发起请求，把获取的内容保存在缓存服务器，把内容返回给用户

通过权威DNS服务器来实现最优节点的选择，通过缓存来减少源站的压力
## 缓存服务 Caching Service
临时缓存动态数据。使用高速缓存服务，在用户第一个请求之后将结果存储一段时间，通过缓存将更快地提供对该数据的后续请求。

缓存服务，本质上是一种特殊类型的数据库。

采用key-value的形式，key是应用程序代码用于查询数据的字符串，value是缓存的实际数据。
缓存数据通常完全保存在内存中，这使得从缓存中检索数据的速度非常快。

常见的缓存服务是 Redis 和 Memcached。
- 都是主流的开源内存数据存储，亚毫秒级的响应时间；易于使用（只要很少代码量就能集中到应用程序中），高性能，可在多个节点之间分发数据；支持广泛的编程语言。
- Memcached为简单而设计，Redis提供丰富的功能
- Memcached多线程架构
- Redis支持快照，复制，发布/订阅等
## 消息队列 Message Queue
有时候，需要执行的任务和响应用户请求没有直接关系，如用户上传了需要编码和水印的视频，这是一项长期运行的任务，让用户在完成时等待是没有意义的，最好是异步执行此操作。

工作任务流：
- 从队列中读取消息
- 处理视频
- 完成后，保存视频的编码副本
- 向用户发送通知电子邮件（消息）
- 从队列中删除消息

可以通过以下方式实现worker 任务：
- 调度 cron 作业，以触发应用程序服务器上安装的指定代码，以便按特定计划从队列中读取

cron，任务调度的 cron 表达式
- 将消息添加到队列时，使用FaaS平台调用工作器代码

### 消息队列MQ简介
消息队列是一种异步的服务间通信方式，适用于无服务器和微服务架构。

消息在被处理和删除之前一直存储在队列上，每个消息仅可被一位用户处理一次。消息队列可被用于分离重量级处理、缓冲或批量处理工作以及缓解高峰期工作负载。

常用的MQ组件有 activeMQ, rabbitMQ, rocketMQ, 还有 kafka。

### MQ主要特性
- 推送或拉取，推送指系统在有可用消息时通知用户（发布/订阅消息收发），拉取是不断查询队列以获取新消息
- 定时或延迟传送，支持为消息设置特定的传送时间，也可为所有消息设置相同延迟
- 至少一次传送，可存储多个消息副本以实现冗余和高可用性，在发送故障或错误时重新发送消息，以确保它们至少经过一次传送
- FIFO队列
- 消息优先级，可分配优先级，以确定要在队列中添加该消息的位置，保证优先级高的位于队列前端优先处理
- 确切一次传送，不允许重复的清况下，MQ会通过自动筛选重复来确保每个消息均精确的传输了一次（且只有一次）

持续集成
1.理解 CI/CD技术的意义，至少熟练掌握一种 CI/CD工具的使用，如 Jenkins
2.可以独自完成架构设计、技术选型、环境搭建、全流程开发、部署上线等一套完整的开发流程（包括 Web应用、移动客户端应用、 PC客户端应用、小程序、 H5等等)
是如何进行code review的，这里讲了持续化集成


后端技能
1.了解后端的开发方式，在应用程序中的作用，至少会使用一种后端语言
2.掌握数据最终在数据库中是如何落地存储的，能看懂表结构设计、表之间的关联，至少会使用一种数据库
数据库的四大特性，什么是原子性，表的关系
mysql 和 mongoDB 有什么区别？
数据库知识、操作系统知识
数据库mysql,redis,mongodb.  sql的操作语句, mongo的操作语句, redis操作语句
